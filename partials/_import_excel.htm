<?php
use RainLab\Location\Models\Country;
use Pensoft\Calendar\Models\Category;
?>

<?= Form::open(['class' => 'layout', 'data-request' => 'onImportExcel', 'data-request-files' => true]) ?>

<div class="layout-row">
    <div class="padded-container">
        <div class="callout callout-info">
            <div class="header">
                <i class="icon-info"></i>
                <h3>Import Events from Excel</h3>
                <p>Upload an Excel file (.xlsx or .xls) to import events into the database.</p>
            </div>
        </div>

        <div class="form-group span-full">
            <label class="control-label">Excel File <span class="required">*</span></label>
            <input
                type="file"
                name="excel_file"
                class="form-control"
                accept=".xlsx,.xls"
                required
            />
            <p class="help-block">Supported formats: .xlsx, .xls</p>
        </div>

        <div class="form-group span-full">
<!--            <label class="control-label">Sheet Name</label>-->
            <input
                type="hidden"
                name="sheet_name"
                class="form-control"
                value="Upload sheet"
                placeholder="Enter sheet name (e.g., Upload sheet)"
            />
<!--            <p class="help-block">Name of the Excel sheet containing the event data.</p>-->
        </div>


        <div class="form-group span-full">
            <label class="control-label">Country <span class="required">*</span></label>
            <select
                name="country_id"
                class="form-control custom-select"
                required
            >
                <option value="">-- Select Country --</option>
                <?php
                    $countries = Country::isEnabled()->lists('name', 'id');
                ?>
                <?php foreach ($countries as $id => $name): ?>
                <option value="<?= $id ?>"><?= e($name) ?></option>
                <?php endforeach; ?>
            </select>
            <p class="help-block">Country will be applied to all imported events.</p>
        </div>

        <div class="form-group span-full">
            <button type="submit" class="btn btn-primary">
                <i class="icon-upload"></i> Import Events
            </button>
            <a href="<?= Backend::url('pensoft/calendar/entries') ?>" class="btn btn-default">
                Cancel
            </a>
        </div>
    </div>
</div>

<style>
    .required {
        color: #c0392b;
    }
    .span-left {
        float: left;
        width: 48%;
        margin-right: 2%;
    }
    .span-right {
        float: left;
        width: 48%;
        margin-left: 2%;
    }
    .span-full {
        clear: both;
    }
    select[multiple] {
        height: auto;
    }
</style>

<?= Form::close() ?>
